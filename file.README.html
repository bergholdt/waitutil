<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.3
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="alphabetic_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h2>waitutil</h2>

<p><a href="https://travis-ci.org/rubytools/waitutil"><img src="https://travis-ci.org/rubytools/waitutil.png?branch=master" alt="Build Status"></a></p>

<p><code>waitutil</code> provides tools for waiting for various conditions to occur, with a configurable
delay time, timeout, and logging.</p>

<p>GitHub: <a href="https://github.com/rubytools/waitutil">https://github.com/rubytools/waitutil</a></p>

<p>RubyGems: <a href="http://rubygems.org/gems/waitutil">http://rubygems.org/gems/waitutil</a></p>

<p>Documentation: <a href="http://rubytools.github.io/waitutil/">http://rubytools.github.io/waitutil/</a></p>

<h3>Examples</h3>

<p>Wait methods take a block that returns <code>true</code> or <code>false</code>.</p>

<h4>Waiting for conditions</h4>

<p><a href="http://rubytools.github.io/waitutil/WaitUtil.html#wait_for_condition-instance_method"><code>wait_for_condition</code></a>
waits for a condition computed by the given function.  It takes two optional
parameters, <code>:timeout_sec</code> and <code>:delay_sec</code>, that control how long the function
waits before raising a timeout exception, and how frequently it checks for the
condition. The time the condition block takes to evaluate is subtracted from
the sleep time between successive checks.  The timeout is one minute by
default, and the delay time is one second.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WaitUtil</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_condition'>wait_for_condition</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my_event to happen</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_check_if_my_event_happened'>check_if_my_event_happened</span>
<span class='kw'>end</span>
</code></pre>

<h5>Customized wait time and delay time</h5>

<pre class="code ruby"><code class="ruby"><span class='const'>WaitUtil</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_condition'>wait_for_condition</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my_event to happen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:timeout_sec</span> <span class='op'>=&gt;</span> <span class='int'>30</span><span class='comma'>,</span> <span class='symbol'>:delay_sec</span> <span class='op'>=&gt;</span> <span class='float'>0.5</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_check_if_my_event_happened'>check_if_my_event_happened</span>
<span class='kw'>end</span>
</code></pre>

<h5>Verbose logging</h5>

<pre class="code ruby"><code class="ruby"><span class='const'>WaitUtil</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_condition'>wait_for_condition</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>my event</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:verbose</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
</code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">I, [2014-02-16T00:34:31.511915 #15897]  INFO -- : Waiting for my event for up to 60 seconds
I, [2014-02-16T00:34:32.512223 #15897]  INFO -- : Success waiting for my event (1.000153273 seconds)
</code></pre>

<h5>Returning additional information for the timeout log message</h5>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_attempt'>attempt</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='const'>WaitUtil</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_condition'>wait_for_condition</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>my event</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:verbose</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:timeout_sec</span> <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span> <span class='symbol'>:delay_sec</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_attempt'>attempt</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attempt </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attempt'>attempt</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>  <span class='comment'># the second element goes into the log message
</span><span class='kw'>end</span>
</code></pre>

<p>Output:</p>

<pre class="code ruby"><code class="ruby">I, [2014-02-16T00:46:53.647936 #17252]  INFO -- : Waiting for my event for up to 3 seconds
WaitUtil::TimeoutError: Timed out waiting for my event (3 seconds elapsed): attempt 3
        from /home/mbautin/.rvm/gems/ruby-2.1.0/gems/waitutil-0.1.0/lib/waitutil.rb:39:in `wait_for_condition'
        from (irb):9
        from /home/mbautin/.rvm/rubies/ruby-2.1.0/bin/irb:11:in `&lt;main&gt;'
</code></pre>

<h4>Waiting for service availability</h4>

<p>Wait for a TCP server to be available using <a href="http://rubytools.github.io/waitutil/WaitUtil.html#wait_for_service-instance_method"><code>wait_for_service</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WaitUtil</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_service'>wait_for_service</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>my service</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>example.com</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
</code></pre>

<h3>License</h3>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a></p>
</div></div>

    <div id="footer">
  Generated on Thu Mar  6 08:16:07 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.3 (ruby-1.9.3).
</div>

  </body>
</html>